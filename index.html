<!DOCTYPE html>
<html>
<head>

	<title>Play with VBA</title>

	<meta charset="utf-8" />
	<meta name="robots" content="index, follow" />
	<meta name="description" content="Anna Janus tłumacz przysięgły">
	<meta name="keywords" content="Anna Janus, tłumacz przysięgły języka francuskiego, tłumacz języka angielskiego, tłumacz przysięgły, tłumaczenie poświadczone, tłumaczenie przysięgłe, tłumaczenie ustne, tłumaczenie pisemne, francuski, angielski, dokumenty, konsekutywne, symultaniczne, szeptane">
	<meta name="author" content="Anna Janus">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="format-detection" content="telephone=no"/>
	
	<link rel="Shortcut icon" href="favicon.png" />
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="style.css" />
	<link href='https://fonts.googleapis.com/css?family=Lato:300,400,700&subset=latin-ext' rel='stylesheet' type='text/css'>
	

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="java.js"></script>

</head>



<body data-spy="scroll" data-target=".navbar" data-offset="70">

<nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="background-color: #2E8B57;">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="index.html"">Play with VBA</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#section">Home</a></li>
        <!--<li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Page 1 <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">Page 1-1</a></li>
            <li><a href="#">Page 1-2</a></li>
            <li><a href="#">Page 1-3</a></li>
          </ul>
        </li>-->
		<li><a href="#section1">Start</a></li>
        <li><a href="#section2">Macros</a></li>
        <li class="visible-xs-block visible-sm-block"><a href="#section3">About</a></li>
      </ul>

    </div>
  </div>
</nav>

      <!--visible-md-block
	  
	  <ul class="nav navbar-nav navbar-right">
        <li><a href="#"><span class=""></span></a></li>
        <li><a href="#"><span class=""></span></a></li>
      </ul>-->



<div class="main">

	<div id="header" style="height: 50px"></div>


	<div class="container">

		<div class="row">
	
			<div class="col-md-9">

				<div id="section" class="dashed">

<h2><p>Are you a beginner in the complex world of VBA macros?

Or have you made the first move and it is time to quicken your pace?

Perhaps you need a set of useful macros at hand?</p>

<p>If answear to any of these questions is yes, then you've got to the right place.

On this website, you will find a bunch of codes ready to be pasted in your Excel file.

<p>It is time to Play with VBA!</h2>

				</div>


				<div class="dashed">

					<div id="section1" class="">
					
<h1>Start - how to paste a macro in Excel?</h1>

<h2>First of all, show the Developer tab if it is hidden by default in your Excel. Click the File tab -> Options -> Customize Ribbon. Under Customize the Ribbon and under Main Tabs, select the Developer check box. </h2> 

<img src="developer.png" class="img-responsive" alt="">

<h2>Next, click Visual Basic on Developer tab in order to open Visual Basic for Application window. Or press Alt + F11</h2>

<img src="excel.png" class="img-responsive" alt="">

<h2>Click This Workbook -> Insert -> Module</h2>

<img src="module1.png" class="img-responsive" alt="">

<h2>Paste code in Module1</h2>

<img src="module2.png" class="img-responsive" alt="">

<h2>Close Visual Basic for Application window. On Developer tab click Macros. Or press Alt + F8</h2>

<img src="excel.png" class="img-responsive" alt="">

<h2>Choose macro from the list and click Run</h2>

<img src="macro.png" class="img-responsive" alt="">

<br>

					</div>

				</div>




<div id="section2" class="">

<div id="Calculate" class="macroouter">

<h1>Macros:</h1>

<h1>Calculate</h1>

<h2>If your calculation option is set to manual it will calculate your selection range.</h2>

<div class="macroinner">

<h3>Sub Calculate()</h3>

<h3>Selection.Calculate</h3>

<h3>End Sub</h3>

</div>

</div>

</div>



<div id="ClearComments" class="macroouter">

<h1>ClearComments</h1>

<h2>Removes comments from the selected range.</h2>

<div class="macroinner">

<h3>Sub ClearComments()</h3>

<h3>For Each cell In Selection</h3>

<h3>cell.ClearComments</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="ColumnWidth" class="macroouter">

<h1>ColumnWidth</h1>

<h2>Specifies column width for a determined range.</h2>

<div class="macroinner">

<h3>Sub ColumnWidth()</h3>

<h3>Dim ColWidth As Integer</h3>

<h3>ColWidth = Application.InputBox("Column width")</h3>

<h3>With ActiveSheet.Columns("A:E")</h3>

<h3>.ColumnWidth = ColWidth</h3>

<h3>End With</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CountDuplicates" class="macroouter">

<h1>CountDuplicates</h1>

<h2>Counts values that appear at least twice in a selected range.</h2>

<div class="macroinner">

<h3>Sub CountDuplicates()</h3>

<h3>For Each cell In Selection</h3>

<h3>If Not IsEmpty(cell) Then _</h3>

<h3>If WorksheetFunction.CountIf(Selection, cell) > 1 Then _</h3>

<h3>count = count + (1 / WorksheetFunction.CountIf(Selection, cell))</h3>

<h3>End If</h3>

<h3>End If</h3>

<h3>Next cell</h3>

<h3>MsgBox count</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CountUnique" class="macroouter">

<h1>CountUnique</h1>

<h2>Counts values that are unique in a selected range.</h2>

<div class="macroinner">

<h3>Sub CountUnique()</h3>

<h3>For Each cell In Selection</h3>

<h3>If Not IsEmpty(cell) Then _</h3>

<h3>If WorksheetFunction.CountIf(Selection, cell) = 1 Then _</h3>

<h3>count = count + 1</h3>

<h3>End If</h3>

<h3>End If</h3>

<h3>Next cell</h3>

<h3>MsgBox count</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CountValue" class="macroouter">

<h1>CountValue</h1>

<h2>Counts any chosen value within a selected range.</h2>

<div class="macroinner">

<h3>Sub CountValue()</h3>

<h3>Dim i As Variant</h3>

<h3>i = InputBox("Name value")</h3>

<h3>MsgBox WorksheetFunction.CountIf(Selection, i)</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CountWords" class="macroouter">

<h1>CountWords</h1>

<h2>The macro counts number of words in a selection.</h2>

<div class="macroinner">

<h3>Sub CountWords()</h3>

<h3>Dim WordCount As Long</h3>

<h3>For Each cell In Selection</h3>

<h3>If IsEmpty(cell) Then</h3>

<h3>WordCount = WordCount</h3>

<h3>Else</h3>

<h3>If cell.HasFormula Then</h3>

<h3>WordCount = WordCount</h3>

<h3>Else</h3>

<h3>If IsNumeric(cell) Then</h3>

<h3>WordCount = WordCount</h3>

<h3>Else</h3>

<h3>WordCount = WordCount + Len(Trim(cell)) - Len(Replace(Trim(cell), " ", "")) + 1</h3>

<h3>End If</h3>

<h3>End If</h3>

<h3>End If</h3>

<h3>Next cell</h3>

<h3>MsgBox WordCount & " words found in the selected range."</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="DeleteEmptyColumns" class="macroouter">

<h1>DeleteEmptyColumns</h1>

<h2>Deletes empty columns for a selected range.</h2>

<div class="macroinner">

<h3>Sub DeleteEmptyColumns()</h3>

<h3>Dim i As Integer</h3>

<h3>For i = Selection.Column + Selection.Columns.count - 1 To Selection.Column Step -1</h3>

<h3>If Application.WorksheetFunction.CountA(Columns(i)) = 0 Then Columns(i).EntireColumn.Delete</h3>

<h3>Next i</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="DeleteEmptyRows" class="macroouter">

<h1>DeleteEmptyRows</h1>

<h2>Deletes empty rows for a selected range.</h2>

<div class="macroinner">

<h3>Sub DeleteEmptyRows()</h3>

<h3>Dim i As Integer</h3>

<h3>For i = Selection.Row + Selection.Rows.count - 1 To Selection.Row Step -1</h3>

<h3>If Application.WorksheetFunction.CountA(Rows(i)) = 0 Then Rows(i).EntireRow.Delete</h3>

<h3>Next i</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="FillBlankCells" class="macroouter">

<h1>FillBlankCells</h1>

<h2>Fills blank cells in a selection with any number or text.</h2>

<div class="macroinner">

<h3>Sub FillBlankCells()</h3>

<h3>Dim i As Variant</h3>

<h3>i = InputBox("Fill in blank cells with...")</h3>

<h3>For Each cell In Selection</h3>

<h3>If IsEmpty(cell) Then cell.Value = i</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="FindOdd" class="macroouter">

<h1>FindOdd</h1>

<h2>Highlights odd numbers in your selected range.</h2>

<div class="macroinner">

<h3>Sub FindOdd()</h3>

<h3>For Each cell In Selection</h3>

<h3>If cell Mod 2 <> 0 Then cell.Interior.ColorIndex = 4 'green</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="FormulasToValues" class="macroouter">

<h1>FormulasToValues</h1>

<h2>Converts formulas to values within a selected range.</h2>

<div class="macroinner">

<h3>Sub FormulasToValues()</h3>

<h3>For Each cell In Selection</h3>

<h3>If cell.HasFormula Then</h3>

<h3>cell.Formula = cell.Value</h3>

<h3>End If</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HighlightCell" class="macroouter">

<h1>HighlightCell</h1>

<h2>Highlighs active cell.</h2>

<div class="macroinner">

<h3>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</h3>

<h3>Application.ScreenUpdating = False</h3>

<h3>Cells.Interior.ColorIndex = 0</h3>

<h3>Target.Interior.ColorIndex = 4 'green</h3>

<h3>Application.ScreenUpdating = True</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HighlightDuplicates" class="macroouter">

<h1>HighlightDuplicates</h1>

<h2>Highlights values that appear at least twice in a selected range.</h2>

<div class="macroinner">

<h3>Sub HighlightDuplicates()</h3>

<h3>For Each cell In Selection</h3>

<h3>If WorksheetFunction.CountIf(Selection, cell) > 1 Then cell.Interior.ColorIndex = 4 'green</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HighlightEvenRows" class="macroouter">

<h1>HighlightEvenRows</h1>

<h2>Highlights odd row numbers within your selected range.</h2>

<div class="macroinner">

<h3>Sub ColorEvenRows()</h3>

<h3>For Each cell In Selection</h3>

<h3>If cell.Row Mod 2 = 0 Then cell.EntireRow.Interior.ColorIndex = 4 'green</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HighlightRowsColumns" class="macroouter">

<h1>HighlightRowsColumns</h1>

<h2>Highlighs row and column of an active cell.</h2>

<div class="macroinner">

<h3>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</h3>

<h3>If Target.Cells.Count > 1 Then Exit Sub</h3>

<h3>Application.ScreenUpdating = False</h3>

<h3>Cells.Interior.ColorIndex = 0</h3>

<h3>With Target</h3>

<h3>    .EntireRow.Interior.ColorIndex = 4 'green</h3>

<h3>    .EntireColumn.Interior.ColorIndex = 4 'green</h3>

<h3>End With</h3>

<h3>Application.ScreenUpdating = True</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HighlightUnique" class="macroouter">

<h1>HighlightUnique</h1>

<h2>Highlights values that are unique in a selected range.</h2>

<div class="macroinner">

<h3>Sub HighlightUnique()</h3>

<h3>For Each cell In Selection</h3>

<h3>If WorksheetFunction.CountIf(Selection, cell) = 1 Then cell.Interior.ColorIndex = 4 'green color</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="InsertRows" class="macroouter">

<h1>InsertRows</h1>

<h2>Inserts empty rows every second line.</h2>

<div class="macroinner">

<h3>Sub InsertRows()</h3>

<h3>Dim i, LastRow As Long</h3>

<h3>LastRow = Cells(Rows.Count, "A").End(xlUp).Row</h3>

<h3>For i = LastRow To 2 Step -1</h3>

<h3>Rows(i).Insert</h3>

<h3>Next i</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="NumberToPercent" class="macroouter">

<h1>NumberToPercent</h1>

<h2>Adds % symbol to numbers and converts them into a percentage.</h2>

<div class="macroinner">

<h3>Sub NumberToPercent()</h3>

<h3>For Each cell In Selection</h3>

<h3>If Not IsEmpty(cell) Then _</h3>

<h3>If IsNumeric(cell) Then cell.Value = cell.Value * 0.01</h3>

<h3>With cell</h3>

<h3>    .NumberFormat = "0.00%"</h3>

<h3>End With</h3>

<h3>End If</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="RemoveNegative" class="macroouter">

<h1>RemoveNegative</h1>

<h2>Converts negative to positive numbers.</h2>

<div class="macroinner">

<h3>Sub RemoveNegative()</h3>

<h3>For Each cell In Selection</h3>

<h3>If cell.Value < 0 Then cell.Value = Abs(cell.Value)</h3>

<h3>Next cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="SaveRangeAsPDF" class="macroouter">

<h1>SaveRangeAsPDF</h1>

<h2>Saves a selected range as PDF.</h2>

<div class="macroinner">

<h3>Sub SaveRangeAsPDF()</h3>

<h3>Selection.ExportAsFixedFormat Type:=xlTypePDF, OpenAfterPublish:=True</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="UnwrapText" class="macroouter">

<h1>UnwrapText</h1>

<h2>Unwraps text within a selected range. </h2>

<div class="macroinner">

<h3>Sub UnwrapText()</h3>

<h3>Selection.WrapText = False 'True = wrap</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="AscWs" class="macroouter">

<h1>AscendingWs</h1>

<h2>The macro sorts worksheets in an ascending order, from a to z. </h2>

<div class="macroinner">

<h3>Sub AscendingWs()</h3>

<h3>Dim x As Integer, y As Integer</h3>

<h3>For x = 1 To Sheets.count</h3>

<h3>For y = 1 To Sheets.count - 1</h3>

<h3>If UCase(Sheets(y).Name) > UCase(Sheets(y + 1).Name) Then</h3>

<h3>Sheets(y).Move after:=Sheets(y + 1)</h3>

<h3>End If</h3>

<h3>Next y</h3>

<h3>Next x</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="Autofit" class="macroouter">

<h1>Autofit</h1>

<h2>Autofits columns and rows in the active worksheet.</h2>

<div class="macroinner">

<h3>Sub Autofit()</h3>

<h3>ActiveSheet.Columns.Autofit</h3>

<h3>ActiveSheet.Rows.Autofit</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CalculateWs" class="macroouter">

<h1>CalculateWs</h1>

<h2>If your calculation option is manual it will calculate within your active worksheet.</h2>

<div class="macroinner">

<h3>Sub CalculateWs()</h3>

<h3>ActiveSheet.Calculate</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="ClearCommentsSheet" class="macroouter">

<h1>ClearCommentsSheet</h1>

<h2>Removes comments from the active worksheet.</h2>

<div class="macroinner">

<h3>Sub ClearCommentsWs()</h3>

<h3>ActiveSheet.Cells.ClearComments</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="ClearFormattingWs" class="macroouter">

<h1>ClearFormattingWs</h1>

<h2>Clears formatting in the active worksheet.</h2>

<div class="macroinner">

<h3>Sub ClearFormattingWs()</h3>

<h3>ActiveSheet.Cells.ClearFormats</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="DescWs" class="macroouter">

<h1>DescWs</h1>

<h2>Macro sorts worksheets in a descending order, from z to a.</h2>

<div class="macroinner">

<h3>Sub DescendingWs()</h3>

<h3>Dim x As Integer, y As Integer</h3>

<h3>For x = 1 To Sheets.count</h3>

<h3>For y = 1 To Sheets.count - 1</h3>

<h3>If UCase(Sheets(y).Name) < UCase(Sheets(y + 1).Name) Then</h3>

<h3>Sheets(y).Move after:=Sheets(y + 1)</h3>

<h3>End If</h3>

<h3>Next y</h3>

<h3>Next x</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="FormulasToValuesWs" class="macroouter">

<h1>FormulasToValuesWs</h1>

<h2>Converts formulas to values within the active worksheet.</h2>

<div class="macroinner">

<h3>Sub FormulasToValuesWs()</h3>

<h3>With ActiveSheet.UsedRange</h3>

<h3>    .Value = .Value</h3>

<h3>End With</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HighlightComments" class="macroouter">

<h1>HighlightComments</h1>

<h2>Highlights cells that contain comments. Works within the active worksheet.</h2>

<div class="macroinner">

<h3>Sub HighlightCommentsWs()</h3>

<h3>Dim rng As Range</h3>

<h3>On Error Resume Next</h3>

<h3>Set rng = Cells.SpecialCells(xlCellTypeComments)</h3>

<h3>If Not rng Is Nothing Then</h3>

<h3>rng.Interior.ColorIndex = 4 'green</h3>

<h3>End If</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="PrintPagesCopies" class="macroouter">

<h1>PrintPagesCopies</h1>

<h2>Prints the active worksheet. You should specify page(s) and number of copies.</h2>

<div class="macroinner">

<h3>Sub PrintPagesCopies()</h3>

<h3>PageFrom = InputBox("From page")</h3>

<h3>PageTo = InputBox("To page")</h3>

<h3>CopiesNr = InputBox("Number of copies")</h3>

<h3>ActiveSheet.PrintOut From:=PageFrom, To:=PageTo, Copies:=CopiesNr</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="PrintSheet" class="macroouter">

<h1>PrintSheet</h1>

<h2>Prints the active worksheet.</h2>

<div class="macroinner">

<h3>Sub PrintSheet()</h3>

<h3>ActiveSheet.PrintOut</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="SaveWsAsPDF" class="macroouter">

<h1>SaveWsAsPDF</h1>

<h2>Saves the active worksheet as a PDF.</h2>

<div class="macroinner">

<h3>Sub SaveWsAsPDF()</h3>

<h3>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, OpenAfterPublish:=True</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="UnhideColumns" class="macroouter">

<h1>UnhideColumns</h1>

<h2>Unhides columns in the active worksheet.</h2>

<div class="macroinner">

<h3>Sub UnhideColumns()</h3>

<h3>Cells.EntireColumn.Hidden = False</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="UnhideColumnsRows" class="macroouter">

<h1>UnhideColumnsRows</h1>

<h2>Unhides columns and rows in the active worksheet.</h2>

<div class="macroinner">

<h3>Sub UnhideColumnsRows()</h3>

<h3>Cells.EntireColumn.Hidden = False</h3>

<h3>Cells.EntireRow.Hidden = False</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="UnhideRows" class="macroouter">

<h1>UnhideRows</h1>

<h2>Unhides rows in the active worksheet.</h2>

<div class="macroinner">

<h3>Sub UnhideRows()</h3>

<h3>Cells.EntireRow.Hidden = False</h3>

<h3>End Sub</h3>

</div>	
	
</div>



<div id="CalculateAuto" class="macroouter">
	
<h1>CalculateAuto</h1>

<h2>Switches to automatic calculation.</h2>

<div class="macroinner">

<h3>Sub CalculateAuto()</h3>

<h3>Application.Calculation = xlCalculationAutomatic</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CalculateMan" class="macroouter">

<h1>CalculateMan</h1>

<h2>Switches to manual calculation.</h2>

<div class="macroinner">

<h3>Sub CalculateMan()</h3>

<h3>Application.Calculation = xlCalculationManual</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="ClearCommentsWb" class="macroouter">

<h1>ClearCommentsWb</h1>

<h2>Removes comments in the entire workbook.</h2>

<div class="macroinner">

<h3>Sub ClearCommentsWb()</h3>

<h3>Dim Ws As Worksheet</h3>

<h3>For Each Ws In ActiveWorkbook.Worksheets</h3>

<h3>Ws.Cells.ClearComments</h3>

<h3>Next Ws</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="ClearFormattingWb" class="macroouter">

<h1>ClearFormattingWb</h1>

<h2>Clears formatting in the workbook.</h2>

<div class="macroinner">

<h3>Sub ClearFormattingWb()</h3>

<h3>Dim Ws As Worksheet</h3>

<h3>For Each Ws In ActiveWorkbook.Worksheets</h3>

<h3>Ws.Cells.ClearFormats</h3>

<h3>Next Ws</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HideEmptyWs" class="macroouter">

<h1>HideEmptyWs</h1>

<h2>Hides empty worksheets from the workbook.</h2>

<div class="macroinner">

<h3>Sub HideEmptyWs()</h3>

<h3>Dim Ws As Worksheet</h3>

<h3>For Each Ws In ActiveWorkbook.Worksheets</h3>

<h3>If Application.CountA(Ws.Cells) = 0 Then Ws.Visible = False</h3>

<h3>Next Ws</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="HighlightNamed" class="macroouter">

<h1>HighlightNamed</h1>

<h2>Highlights named ranges in your workbook.</h2>

<div class="macroinner">

<h3>Sub HighlightNamed()</h3>

<h3>Dim RngNm As Name</h3>

<h3>Dim rng As Range</h3>

<h3>On Error Resume Next</h3>

<h3>For Each RngNm In Application.ActiveWorkbook.Names</h3>

<h3>Set rng = RngNm.RefersToRange</h3>

<h3>rng.Interior.ColorIndex = 4 'green</h3>

<h3>Next</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="PasswordWb" class="macroouter">

<h1>PasswordWb</h1>

<h2>Secures file with a password.</h2>

<div class="macroinner">

<h3>Sub PasswordWb()</h3>

<h3>On Error GoTo ErrorHandler:</h3>

<h3>Dim pass As Variant</h3>

<h3>pass = InputBox("Please enter the password")</h3>

<h3>ActiveWorkbook.SaveAs Password:=pass 'Filename:="Pelna_Nazwa_Pliku",</h3>

<h3>Exit Sub</h3>

<h3>ErrorHandler:</h3>

<h3>MsgBox "Failed to set password for workbook"</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="ProtectWb" class="macroouter">

<h1>ProtectWb</h1>

<h2>Protects the workbook from structure changes.</h2>

<div class="macroinner">

<h3>Sub ProtectWb()</h3>

<h3>On Error GoTo ErrorHandler:</h3>

<h3>Dim pass As Variant</h3>

<h3>pass = InputBox("Please enter the password")</h3>

<h3>ActiveWorkbook.Protect Structure:=True, Windows:=True, Password:=pass</h3>

<h3>MsgBox "Workbook protected"</h3>

<h3>Exit Sub</h3>

<h3>ErrorHandler:</h3>

<h3>MsgBox "Failed to protect workbook"</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="RemoveEmptyWs" class="macroouter">

<h1>RemoveEmptyWs</h1>

<h2>Removes empty worksheets from the workbook.</h2>

<div class="macroinner">

<h3>Sub RemoveEmptyWs()</h3>

<h3>Application.DisplayAlerts = False</h3>

<h3>Dim Ws As Worksheet</h3>

<h3>For Each Ws In ActiveWorkbook.Worksheets</h3>

<h3>If Application.CountA(Ws.Cells) = 0 Then Ws.Delete</h3>

<h3>Next Ws</h3>

<h3>Application.DisplayAlerts = True</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="RemoveNamed" class="macroouter">

<h1>RemoveNamed</h1>

<h2>Removes named ranges from your workbook.</h2>

<div class="macroinner">

<h3>Sub RemoveNamed()</h3>

<h3>Dim RngNm As Name</h3>

<h3>Dim rng As Range</h3>

<h3>On Error Resume Next</h3>

<h3>For Each RngNm In Application.ActiveWorkbook.Names</h3>

<h3>    RngNm.Delete</h3>

<h3>Next</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="UnhideWs" class="macroouter">

<h1>UnhideWs</h1>

<h2>Unhides hidden worksheets.</h2>

<div class="macroinner">

<h3>Sub UnhideWs()</h3>

<h3>Dim Ws As Worksheet</h3>

<h3>For Each Ws In ActiveWorkbook.Worksheets</h3>

<h3>Ws.Visible = True</h3>

<h3>Next Ws</h3>

<h3>End Sub</h3>

</div>	
	
</div>



<div id="CloseAllWb" class="macroouter">	
	
<h1>CloseAllWb</h1>

<h2>Closes all open workbooks at once.</h2>

<div class="macroinner">

<h3>Sub CloseAllWb()</h3>

<h3>Dim wb As Workbook</h3>

<h3>For Each wb In Workbooks</h3>

<h3>wb.Close savechanges:=False 'or True if you want changes saved</h3>

<h3>Next wb</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CloseExcel" class="macroouter">

<h1>CloseExcel</h1>

<h2>Closes the Excel application.</h2>

<div class="macroinner">

<h3>Sub CloseExcel()</h3>

<h3>Application.DisplayAlerts = False</h3>

<h3>ThisWorkbook.Save</h3>

<h3>Application.DisplayAlerts = True</h3>

<h3>Application.Quit</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CloseOtherWb" class="macroouter">

<h1>CloseOtherWb</h1>

<h2>Closes all open workbooks at once, apart from the active workbook.</h2>

<div class="macroinner">

<h3>Sub CloseOtherWb()</h3>

<h3>Dim wb As Workbook</h3>

<h3>For Each wb In Workbooks</h3>

<h3>If wb.Name <> ThisWorkbook.Name Then</h3>

<h3>wb.Close savechanges:=False 'or True if you want changes saved</h3>

<h3>End If</h3>

<h3>Next wb</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="ConvertToRoman" class="macroouter">

<h1>ConvertToRoman</h1>

<h2>Converts arabic numbers to roman numbers.</h2>

<div class="macroinner">

<h3>Sub ConvertToRoman()</h3>

<h3>For Each Cell In Selection</h3>

<h3>If IsNumeric(Cell) = True Then Cell.Value = Application.WorksheetFunction.Roman(Cell.Value, 0) 'max 3999</h3>

<h3>Next Cell</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="CountTime" class="macroouter">

<h1>CountTime</h1>

<h2>Counts time spent in the workbook.</h2>

<div class="macroinner">

<h3>Public Start As Double</h3>

<h3>Public Finish As String</h3>

<h3>Private Sub Workbook_BeforeClose(Cancel As Boolean)</h3>

<h3>Finish = Format((Timer - Start) / 86400, "hh:mm:ss")</h3>

<h3>MsgBox "Time spent on This workbook " & Finish, vbInformation</h3>

<h3>End Sub</h3>

<h3>Private Sub Workbook_Open()</h3>

<h3>Start = Timer</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="FirstLastDayMonth" class="macroouter">

<h1>FirstLastDayMonth</h1>

<h2>The macro shows the first and the last day of the month in the open file.</h2>

<div class="macroinner">

<h3>Sub Auto_Open()</h3>

<h3>Call FirstDayMonth</h3>

<h3>Call LastDayMonth</h3>

<h3>End Sub</h3>

<h3>Sub FirstDayMonth()</h3>

<h3>Dim FirstDay As Date</h3>

<h3>FirstDay = DateSerial(Year(Date), Month(Date), 1)</h3>

<h3>MsgBox FirstDay</h3>

<h3>End Sub</h3>

<h3>Sub LastDayMonth()</h3>

<h3>Dim LastDay As Date</h3>

<h3>LastDay = DateSerial(Year(Date), Month(Date) + 1, 0)</h3>

<h3>MsgBox LastDay</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="LastAuthorSaveTime" class="macroouter">

<h1>LastAuthorSaveTime</h1>

<h2>The macro identifies the last author and save date.</h2>

<div class="macroinner">

<h3>Sub LastAuthorSaveTime()</h3>

<h3>Dim FileAuthor As Object</h3>

<h3>Set FileAuthor = ThisWorkbook.BuiltinDocumentProperties("Last Author")</h3>

<h3>Dim FileDate As Object</h3>

<h3>Set FileDate = ThisWorkbook.BuiltinDocumentProperties("Last Save Time")</h3>

<h3>MsgBox "Last Updated By: " & FileAuthor & " on " & FileDate</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="Reminder" class="macroouter">

<h1>Reminder</h1>

<h2>The macro activates on a pre-determined weekday to remind you about an event.</h2>

<div class="macroinner">

<h3>Private Sub Workbook_Open()</h3>

<h3>If Weekday(Now()) = vbWednesday Then</h3>

<h3>MsgBox "Today is Wednesday. Remember about..."</h3>

<h3>End If</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="RestrictAccess" class="macroouter">

<h1>RestrictAccess</h1>

<h2>Allows or restricts access depending on the system user name.</h2>

<div class="macroinner">

<h3>Private Sub Workbook_Open()</h3>

<h3>If Application.UserName = "admin" Then</h3>

<h3>MsgBox "Hello " & Application.UserName</h3>

<h3>Else</h3>

<h3>MsgBox "You are not entitled to use this file"</h3>

<h3>Application.Quit</h3>

<h3>End If</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="SaveFileCopy" class="macroouter">

<h1>SaveFileCopy</h1>

<h2>Creates a copy of your file. The copy is created in the location of your original file. Its name will contain today's date.</h2>

<div class="macroinner">

<h3>Sub SaveFileCopy()</h3>

<h3>ActiveWorkbook.SaveCopyAs ActiveWorkbook.Path & "\" & Date & " Copy of " & ActiveWorkbook.Name</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="StartCalculator" class="macroouter">

<h1>StartCalculator</h1>

<h2>Opens a calculator from Excel level.</h2>

<div class="macroinner">

<h3>Sub StartCalculator()</h3>

<h3>Application.ActivateMicrosoftApp Index:=0</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="StartMsWord" class="macroouter">

<h1>StartMsWord</h1>

<h2>Opens MS Word from Excel level.</h2>

<div class="macroinner">

<h3>Sub StartMsWord()</h3>

<h3>Application.ActivateMicrosoftApp xlMicrosoftWord 'or Index:=1</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="TimeCountMin" class="macroouter">

<h1>TimeCountMin</h1>

<h2>Counts time in minutes.</h2>

<div class="macroinner">

<h3>Sub TimeCountMin()</h3>

<h3>Dim Start As Double</h3>

<h3>Dim Finish As String</h3>

<h3>Start = Timer</h3>

<h3>'Macro starts</h3>

<h3>For Each cell In Selection</h3>

<h3>If IsEmpty(cell) = True Then</h3>

<h3>cell.Value = 1</h3>

<h3>End If</h3>

<h3>Next cell</h3>

<h3>'Maro ends</h3>

<h3>Finish = Format((Timer - Start) / 86400, "hh:mm:ss")</h3>

<h3>MsgBox Finish & " minutes", vbInformation</h3>

<h3>End Sub</h3>

</div>

</div>



<div id="TimeCountSec" class="macroouter">

<h1>TimeCountSec</h1>

<h2>Counts time in seconds.</h2>

<div class="macroinner">

<h3>Sub TimeCountSec()</h3>

<h3>Dim Start As Double</h3>

<h3>Dim Finish As Double</h3>

<h3>Start = Timer</h3>

<h3>'Macro starts</h3>

<h3>For Each cell In Selection</h3>

<h3>If IsEmpty(cell) = True Then</h3>

<h3>cell.Value = 1</h3>

<h3>End If</h3>

<h3>Next cell</h3>

<h3>'Maro ends</h3>

<h3>Finish = Round(Timer - Start, 0)</h3>

<h3>MsgBox Finish & " seconds", vbInformation</h3>

<h3>End Sub</h3>

</div>

</div>

<br>

<br>



</div>




<div class="col-md-3 hidden-xs hidden-sm">


<div id="" class="dashed">

<img src="Photo.png" class="img-responsive" alt="Photo of Piotr Janus">

<h4>

<p>Hi,</p>

<p>My name is Piotr Janus.</p>

<p>I believe that playing with VBA can give you a lot of fun.

Moreover, it may be useful in your professional career. Perhaps not everyone may have a knack for macros but everyone can profit from it.</p>

<p>On Play with VBA website I have gathered macros that I have developed thoughout my carrer of an analyst and consultant in financial institutions.

I would like to invite you to explore the content of the site.

Remember that <i>knowledge is power</i> as Francis Bacon once said.</p>

<p>Contact me:</p>

<!--mail--><a href="mailto:piotrjanus@outlook.com?Subject=Hi Piotr" style="color: #0e5051" target="_top">piotrjanus@outlook.com</a>

<!--Linkedin--><a href="https://pl.linkedin.com/in/januspiotr"><img src="In-2C-28px-TM.png" align="right" style="margin-right: 0px; margin-left: 0px; padding-top: px;"></a>

</h4>

</div>

<div class="dashed">
	<div class="grey-bg container-fluid">
		<div class="row slideanim" id="counter">
			<div class="counter-Txt"><h5>Currently available on the website</h5><h5><span class="counter-value" data-count="62">0</span></h5><h5>VBA macros</h5></div>
		</div>
	</div>
</div>

<div id="" class="list">
<br>
<h4><b><a href="#range">Range</a></b></h4>
<h4><a href="#Calculate">Calculate</a></h4>
<h4><a href="#ClearComments">ClearComments</a></h4>
<h4><a href="#ColumnWidth">ColumnWidth</a></h4>
<h4><a href="#CountDuplicates">CountDuplicates</a></h4>
<h4><a href="#CountUnique">CountUnique</a></h4>
<h4><a href="#CountValue">CountValue</a></h4>
<h4><a href="#CountWords">CountWords</a></h4>
<h4><a href="#DeleteEmptyColumns">DeleteEmptyColumns</a></h4>
<h4><a href="#DeleteEmptyRows">DeleteEmptyRows</a></h4>
<h4><a href="#FillBlankCells">FillBlankCells</a></h4>
<h4><a href="#FindOdd">FindOdd</a></h4>
<h4><a href="#FormulasToValues">FormulasToValues</a></h4>
<h4><a href="#HighlightCell">HighlightCell</a></h4>
<h4><a href="#HighlightDuplicates">HighlightDuplicates</a></h4>
<h4><a href="#HighlightEvenRows">HighlightEvenRows</a></h4>
<h4><a href="#HighlightRowsColumns">HighlightRowsColumns</a></h4>
<h4><a href="#HighlightUnique">HighlightUnique</a></h4>
<h4><a href="#InsertRows">InsertRows</a></h4>
<h4><a href="#NumberToPercent">NumberToPercent</a></h4>
<h4><a href="#RemoveNegative">RemoveNegative</a></h4>
<h4><a href="#SaveRangeAsPDF">SaveRangeAsPDF</a></h4>
<h4><a href="#UnwrapText">UnwrapText</a></h4>
<br>

<a href="#">

<h4><b><a href="#Worksheet">Worksheet</a></b></h4>
<h4><a href="#AscWs">AscWs</a></h4>
<h4><a href="#Autofit">Autofit</a></h4>
<h4><a href="#CalculateWs">CalculateWs</a></h4>
<h4><a href="#ClearCommentsSheet">ClearCommentsSheet</a></h4>
<h4><a href="#ClearFormattingWs">ClearFormattingWs</a></h4>
<h4><a href="#DescWs">DescWs</a></h4>
<h4><a href="#FormulasToValuesWs">FormulasToValuesWs</a></h4>
<h4><a href="#HighlightComments">HighlightComments</a></h4>
<h4><a href="#PrintPagesCopies">PrintPagesCopies</a></h4>
<h4><a href="#PrintSheet">PrintSheet</a></h4>
<h4><a href="#SaveWsAsPDF">SaveWsAsPDF</a></h4>
<h4><a href="#UnhideColumns">UnhideColumns</a></h4>
<h4><a href="#UnhideColumnsRows">UnhideColumnsRows</a></h4>
<h4><a href="#UnhideRows">UnhideRows</a></h4>
<br>


<h4><b><a href="#Workbook">Workbook</a></b></h4>
<h4><a href="#CalculateAuto">CalculateAuto</a></h4>
<h4><a href="#CalculateMan">CalculateMan</a></h4>
<h4><a href="#ClearCommentsWb">ClearCommentsWb</a></h4>
<h4><a href="#ClearFormattingWb">ClearFormattingWb</a></h4>
<h4><a href="#HideEmptyWs">HideEmptyWs</a></h4>
<h4><a href="#HighlightNamed">HighlightNamed</a></h4>
<h4><a href="#PasswordWb">PasswordWb</a></h4>
<h4><a href="#ProtectWb">ProtectWb</a></h4>
<h4><a href="#RemoveEmptyWs">RemoveEmptyWs</a></h4>
<h4><a href="#RemoveNamed">RemoveNamed</a></h4>
<h4><a href="#UnhideWs">UnhideWs</a></h4>
<br>


<h4><b><a href="#Other">Other</a></b></h4>
<h4><a href="#CloseAllWb">CloseAllWb</a></h4>
<h4><a href="#CloseExcel">CloseExcel</a></h4>
<h4><a href="#CloseOtherWb">CloseOtherWb</a></h4>
<h4><a href="#ConvertToRoman">ConvertToRoman</a></h4>
<h4><a href="#CountTime">CountTime</a></h4>
<h4><a href="#FirstLastDayMonth">FirstLastDayMonth</a></h4>
<h4><a href="#LastAuthorSaveTime">LastAuthorSaveTime</a></h4>
<h4><a href="#Reminder">Reminder</a></h4>
<h4><a href="#RestrictAccess">RestrictAccess</a></h4>
<h4><a href="#SaveFileCopy">SaveFileCopy</a></h4>
<h4><a href="#StartCalculator">StartCalculator</a></h4>
<h4><a href="#StartMsWord">StartMsWord</a></h4>
<h4><a href="#TimeCountMin">TimeCountMin</a></h4>
<h4><a href="#TimeCountSec">TimeCountSec</a></h4>
<br>


</div>

</div>



<div id="section3" class="">

<div class="col-xs-12 col-sm-4 hidden-md hidden-lg hidden-xl">

<img src="Photo.png" class="img-responsive" alt="Photo of Piotr Janus">

</div>

<div class="col-xs-12 col-sm-8 hidden-md hidden-lg hidden-xl">



<h4>

<p>Hi,</p>

<p>My name is Piotr Janus.</p>

<p>I believe that playing with VBA can give you a lot of fun.

Moreover, it may be useful in your professional career. Perhaps not everyone may have a knack for macros but everyone can profit from it.</p>

<p>On Play with VBA website I have gathered macros that I have developed thoughout my carrer of an analyst and consultant in financial institutions.

I would like to invite you to explore the content of the site.

Remember that <i>knowledge is power</i> as Francis Bacon once said.</p>

<p>Contact me:</p>

<!--mail--><a href="mailto:piotrjanus@outlook.com?Subject=Hi Piotr" style="color: #0e5051" target="_top">piotrjanus@outlook.com</a>

<!--Linkedin--><a href="https://pl.linkedin.com/in/januspiotr"><img src="In-2C-28px-TM.png" align="right" style="margin-right: 0px; margin-left: 0px; padding-top: px;"></a>

</h4>



<!--
	<div class="grey-bg container-fluid">
		<div class="row slideanim" id="counter">
			<div class="counter-Txt"><h5>Currently available on the website</h5><h5><span class="counter-value" data-count="62">0</span></h5><h5>VBA macros</h5></div>
		</div>
	</div>
-->

</div>





</div>

</div>


</div> <!--row-->

</div> <!--container-->


</div> <!--class main-->

<!--scripts-->

<script>
$(window).bind("load", function() {

$(document).ready(function(){
	$('a[href^="#"]').on('click',function (e) {
	    e.preventDefault();

	    var target = this.hash;
	    var $target = $(target);

	    $('html, body').stop().animate({
	        'scrollTop': $target.offset().top - 69
	    }, 650, 'swing');
	});
});
/*https://stackoverflow.com/questions/11365091/jquery-scroll-to-anchor-minus-set-amount-of-pixels*/

/*Fix to problem in IE and Mozilla
https://stackoverflow.com/questions/18107597/jquery-scrolltop-offset-issue*/
});

/*if this is turn on dropdown menu links don't work*/
/*$(window).bind("load", function() {

$(document).ready(function () {
        $('ul.nav > li').click(function (e) {
            e.preventDefault();
            $('ul.nav > li').removeClass('active');
            $(this).addClass('active');                
        });            
    });

});*/

$(window).bind("load", function() {

$(document).on('click','.navbar-collapse.in',function(e) {
    if( $(e.target).is('a') ) {
        $(this).collapse('hide');
    }
});

});




$(window).bind("load", function() {

/*counter https://bootsnipp.com/snippets/o1V0y*/
var a = 0;
$(window).scroll(function() {

  var oTop = $('#counter').offset().top - window.innerHeight;
  if (a == 0 && $(window).scrollTop() > oTop) {
    $('.counter-value').each(function() {
      var $this = $(this),
        countTo = $this.attr('data-count');
      $({
        countNum: $this.text()
      }).animate({
          countNum: countTo
        },

        {

          duration: 2000,
          easing: 'swing',
          step: function() {
            $this.text(Math.floor(this.countNum));
          },
          complete: function() {
            $this.text(this.countNum);
            //alert('finished');
          }

        });
    });
    a = 1;
  }

});

});

$(window).bind("load", function() {

/*https://www.w3schools.com/bootstrap/bootstrap_theme_company.asp*/
/*slide*/
$(window).scroll(function() {
  $(".slideanim").each(function(){
    var pos = $(this).offset().top;

    var winTop = $(window).scrollTop();
    if (pos < winTop + 600) {
      $(this).addClass("slide2");
    }
  });
});

});
</script>


</body>

<footer>
	<div id="" class="container-fluid" style="background-color: #2E8B57;">
		<div class="container">
			<div class="row" style="height: 55px">
				<div class="col-xs-12" style="color: #FFFFFF";>
					<h3><p align="right">Copyright &copy; 2017 Piotr Janus</p></h3 >
				</div>
			</div>
		</div>
	</div>
</footer>

</html>